extends ../layout/frame
block content
	.container
		.page-header
			h1 DEF 配置
		
		.tabbable
			ul.nav.nav-tabs
				li.active
					a(href="#tab1",data-toggle="tab") 基础配置
				- each plugin in plugins
					li
						a(href="##{plugin.name}",data-toggle="tab") #{plugin.name}
				
			.tab-content
				#tab1.tab-pane.active
					form#rootSetting.form-horizontal(action="/setting/saveRoot")
						.control-group
							label.control-label(for="rootdir") DEF根目录
							.controls
								input#rootDir(type="text",name="rootDir",value="#{root}",placeholder="D:\\\\FIDE(window) or /FIDE(linux)")
						.control-group
							.controls
								button.btn(type="submit") 确定
				- each plugin in plugins
					.tab-pane(id="#{plugin.name}")
						iframe.plugin-setting(src="http://localhost:#{plugin.port}/#{plugin.settingPage}")
	script(src="/static/kissy-min.js")
	script
		KISSY.ready(function(){
			var S = KISSY,
				E = S.Event,
				D = S.DOM,
				IO = S.IO;
			E.on('#rootSetting','submit',function(e){
				e.halt();
				IO.getScript("/setting/saveRoot?rootDir=" + D.get("#rootDir").value + "&callback=saveRootHandler");
			})
		});
		function saveRootHandler(result){
			if(result.state === "success"){
				alert("设置成功");
			}else{
				alert(result.msg);
			}
		}
		
